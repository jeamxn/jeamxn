"use client";

import { useAtomValue, useSetAtom } from "jotai";
import Link from "next/link";
import React from "react";

import { headerHeightAtom } from "@front/utils/states";

import Logo from "./logo";

const menuItems = [
  { name: "About me", id: "about" },
  { name: "Awards", id: "awards" },
  { name: "Projects", id: "projects" },
];

const Header = () => {
  const setHeight = useSetAtom(headerHeightAtom);
  const headerRef = React.useRef<HTMLDivElement>(null);
  const headerHeight = useAtomValue(headerHeightAtom);

  React.useEffect(() => {
    const node = headerRef.current;
    if (!node) return;

    const updateHeight = () => {
      setHeight(node.offsetHeight);
    };

    updateHeight();

    const resizeObserver = new window.ResizeObserver(updateHeight);
    resizeObserver.observe(node);

    return () => {
      resizeObserver.disconnect();
    };
  }, [setHeight]);

  return (
    <div className="fixed top-0 left-0 z-50 bg-stone-50/50 dark:bg-stone-800/50 backdrop-blur-lg w-full">
      <div className="px-10 py-6 flex flex-row items-center justify-between" ref={headerRef}>
        <div className="flex flex-row items-center gap-8">
          <button 
            onClick={() => {
              window.scrollTo({
                top: 0,
                behavior: "smooth",
              });
            }}
          >
            <Logo className="w-7 h-w-7" />
          </button>
          <div className="flex flex-row items-center gap-6 max-sm:hidden">
            {
              menuItems.map((item) => (
                <button
                  className="cursor-pointer"
                  key={item.id}
                  onClick={() => {
                    window.scrollTo({
                      top: (document.getElementById(item.id)?.offsetTop || 0) - headerHeight,
                      behavior: "smooth",
                    });
                  }}
                >
                  <p>{item.name}</p>
                </button>
              ))
            }
          </div>
        </div>
        <div className="flex flex-row items-center gap-6">
          <Link href="https://www.instagram.com/jeamxn" target="_blank">
            <button className="flex flex-row items-center gap-2 cursor-pointer">
              <svg className="w-5 h-5" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path className="fill-stone-700 dark:fill-stone-50" d="M10.0039 5.50781C7.51953 5.50781 5.51562 7.51172 5.51562 9.99609C5.51562 12.4805 7.51953 14.4844 10.0039 14.4844C12.4883 14.4844 14.4922 12.4805 14.4922 9.99609C14.4922 7.51172 12.4883 5.50781 10.0039 5.50781ZM10.0039 12.9141C8.39844 12.9141 7.08594 11.6055 7.08594 9.99609C7.08594 8.38672 8.39453 7.07812 10.0039 7.07812C11.6133 7.07812 12.9219 8.38672 12.9219 9.99609C12.9219 11.6055 11.6094 12.9141 10.0039 12.9141ZM15.7227 5.32422C15.7227 5.90625 15.2539 6.37109 14.6758 6.37109C14.0938 6.37109 13.6289 5.90234 13.6289 5.32422C13.6289 4.74609 14.0977 4.27734 14.6758 4.27734C15.2539 4.27734 15.7227 4.74609 15.7227 5.32422ZM18.6953 6.38672C18.6289 4.98438 18.3086 3.74219 17.2813 2.71875C16.2578 1.69531 15.0156 1.375 13.6133 1.30469C12.168 1.22266 7.83594 1.22266 6.39063 1.30469C4.99219 1.37109 3.75 1.69141 2.72266 2.71484C1.69531 3.73828 1.37891 4.98047 1.30859 6.38281C1.22656 7.82812 1.22656 12.1602 1.30859 13.6055C1.375 15.0078 1.69531 16.25 2.72266 17.2734C3.75 18.2969 4.98828 18.6172 6.39063 18.6875C7.83594 18.7695 12.168 18.7695 13.6133 18.6875C15.0156 18.6211 16.2578 18.3008 17.2813 17.2734C18.3047 16.25 18.625 15.0078 18.6953 13.6055C18.7773 12.1602 18.7773 7.83203 18.6953 6.38672ZM16.8281 15.1562C16.5234 15.9219 15.9336 16.5117 15.1641 16.8203C14.0117 17.2773 11.2773 17.1719 10.0039 17.1719C8.73047 17.1719 5.99219 17.2734 4.84375 16.8203C4.07812 16.5156 3.48828 15.9258 3.17969 15.1562C2.72266 14.0039 2.82813 11.2695 2.82813 9.99609C2.82813 8.72266 2.72656 5.98437 3.17969 4.83594C3.48438 4.07031 4.07422 3.48047 4.84375 3.17187C5.99609 2.71484 8.73047 2.82031 10.0039 2.82031C11.2773 2.82031 14.0156 2.71875 15.1641 3.17187C15.9297 3.47656 16.5195 4.06641 16.8281 4.83594C17.2852 5.98828 17.1797 8.72266 17.1797 9.99609C17.1797 11.2695 17.2852 14.0078 16.8281 15.1562Z" />
              </svg>
              <p className="underline max-md:hidden">Instagram</p>
            </button>
          </Link>
          <Link href="https://github.com/jeamxn" target="_blank">
            <button className="flex flex-row items-center gap-2 cursor-pointer">
              <svg className="w-5 h-5" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g clipPath="url(#clip0_476_120)">
                  <path className="fill-stone-700 dark:fill-stone-50" d="M6.79297 15.5234C6.79297 15.6016 6.70312 15.6641 6.58984 15.6641C6.46094 15.6758 6.37109 15.6133 6.37109 15.5234C6.37109 15.4453 6.46094 15.3828 6.57422 15.3828C6.69141 15.3711 6.79297 15.4336 6.79297 15.5234ZM5.57813 15.3477C5.55078 15.4258 5.62891 15.5156 5.74609 15.5391C5.84766 15.5781 5.96484 15.5391 5.98828 15.4609C6.01172 15.3828 5.9375 15.293 5.82031 15.2578C5.71875 15.2305 5.60547 15.2695 5.57813 15.3477ZM7.30469 15.2813C7.19141 15.3086 7.11328 15.3828 7.125 15.4727C7.13672 15.5508 7.23828 15.6016 7.35547 15.5742C7.46875 15.5469 7.54687 15.4727 7.53516 15.3945C7.52344 15.3203 7.41797 15.2695 7.30469 15.2813ZM9.875 0.3125C4.45703 0.3125 0.3125 4.42578 0.3125 9.84375C0.3125 14.1758 3.03906 17.8828 6.93359 19.1875C7.43359 19.2773 7.60938 18.9688 7.60938 18.7148C7.60938 18.4727 7.59766 17.1367 7.59766 16.3164C7.59766 16.3164 4.86328 16.9023 4.28906 15.1523C4.28906 15.1523 3.84375 14.0156 3.20312 13.7227C3.20312 13.7227 2.30859 13.1094 3.26562 13.1211C3.26562 13.1211 4.23828 13.1992 4.77344 14.1289C5.62891 15.6367 7.0625 15.2031 7.62109 14.9453C7.71094 14.3203 7.96484 13.8867 8.24609 13.6289C6.0625 13.3867 3.85938 13.0703 3.85938 9.3125C3.85938 8.23828 4.15625 7.69922 4.78125 7.01172C4.67969 6.75781 4.34766 5.71094 4.88281 4.35937C5.69922 4.10547 7.57812 5.41406 7.57812 5.41406C8.35938 5.19531 9.19922 5.08203 10.0313 5.08203C10.8633 5.08203 11.7031 5.19531 12.4844 5.41406C12.4844 5.41406 14.3633 4.10156 15.1797 4.35937C15.7148 5.71484 15.3828 6.75781 15.2813 7.01172C15.9063 7.70313 16.2891 8.24219 16.2891 9.3125C16.2891 13.082 13.9883 13.3828 11.8047 13.6289C12.1641 13.9375 12.4688 14.5234 12.4688 15.4414C12.4688 16.7578 12.457 18.3867 12.457 18.707C12.457 18.9609 12.6367 19.2695 13.1328 19.1797C17.0391 17.8828 19.6875 14.1758 19.6875 9.84375C19.6875 4.42578 15.293 0.3125 9.875 0.3125ZM4.10937 13.7852C4.05859 13.8242 4.07031 13.9141 4.13672 13.9883C4.19922 14.0508 4.28906 14.0781 4.33984 14.0273C4.39062 13.9883 4.37891 13.8984 4.3125 13.8242C4.25 13.7617 4.16016 13.7344 4.10937 13.7852ZM3.6875 13.4687C3.66016 13.5195 3.69922 13.582 3.77734 13.6211C3.83984 13.6602 3.91797 13.6484 3.94531 13.5938C3.97266 13.543 3.93359 13.4805 3.85547 13.4414C3.77734 13.418 3.71484 13.4297 3.6875 13.4687ZM4.95313 14.8594C4.89063 14.9102 4.91406 15.0273 5.00391 15.1016C5.09375 15.1914 5.20703 15.2031 5.25781 15.1406C5.30859 15.0898 5.28516 14.9727 5.20703 14.8984C5.12109 14.8086 5.00391 14.7969 4.95313 14.8594ZM4.50781 14.2852C4.44531 14.3242 4.44531 14.4258 4.50781 14.5156C4.57031 14.6055 4.67578 14.6445 4.72656 14.6055C4.78906 14.5547 4.78906 14.4531 4.72656 14.3633C4.67188 14.2734 4.57031 14.2344 4.50781 14.2852Z" />
                </g>
              </svg>
              <p className="underline max-md:hidden">Github</p>
            </button>
          </Link>
          <Link href="mailto:me@jeamxn.dev">
            <button className="flex flex-row items-center gap-1 cursor-pointer">
              <svg className="w-5 h-5" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <g mask="url(#mask0_476_188)">
                  <path className="fill-stone-700 dark:fill-stone-50" d="M10 19C8.75975 19 7.59422 18.7656 6.50341 18.2969C5.41259 17.8281 4.45703 17.1836 3.63672 16.3633C2.81641 15.543 2.17188 14.5863 1.70312 13.4932C1.23437 12.4001 1 11.2321 1 9.98927C1 8.74642 1.23437 7.58203 1.70312 6.49609C2.17188 5.41016 2.81641 4.45703 3.63672 3.63672C4.45703 2.81641 5.41373 2.17188 6.50683 1.70312C7.59994 1.23437 8.76791 1 10.0107 1C11.2536 1 12.418 1.23437 13.5039 1.70312C14.5898 2.17188 15.543 2.81641 16.3633 3.63672C17.1836 4.45703 17.8281 5.41016 18.2969 6.49609C18.7656 7.58203 19 8.75 19 10V11.4062C19 12.2632 18.6992 12.9931 18.0977 13.5959C17.4961 14.1986 16.7656 14.5 15.9062 14.5C15.375 14.5 14.8867 14.3672 14.4414 14.1016C13.9961 13.8359 13.6159 13.4844 13.3009 13.0469C12.8659 13.5 12.3633 13.8555 11.793 14.1133C11.2227 14.3711 10.625 14.5 10 14.5C8.755 14.5 7.69375 14.0607 6.81625 13.1822C5.93875 12.3037 5.5 11.2412 5.5 9.9947C5.5 8.74823 5.93927 7.6875 6.8178 6.8125C7.69633 5.9375 8.75883 5.5 10.0053 5.5C11.2518 5.5 12.3125 5.93875 13.1875 6.81625C14.0625 7.69375 14.5 8.755 14.5 10V11.4062C14.5 11.7994 14.6367 12.1321 14.9102 12.4042C15.1836 12.6764 15.5156 12.8125 15.9062 12.8125C16.2969 12.8125 16.6289 12.6764 16.9023 12.4042C17.1758 12.1321 17.3125 11.7994 17.3125 11.4062V10C17.3125 7.96875 16.6016 6.24219 15.1797 4.82031C13.7578 3.39844 12.0313 2.6875 10 2.6875C7.96875 2.6875 6.24219 3.39844 4.82031 4.82031C3.39844 6.24219 2.6875 7.96875 2.6875 10C2.6875 12.0313 3.39844 13.7578 4.82031 15.1797C6.24219 16.6016 7.97152 17.3125 10.0083 17.3125H13.6562C13.8953 17.3125 14.0957 17.3929 14.2574 17.5536C14.4191 17.7144 14.5 17.9136 14.5 18.1513C14.5 18.389 14.4191 18.5898 14.2574 18.7539C14.0957 18.918 13.8953 19 13.6562 19H10ZM10 12.8125C10.7812 12.8125 11.4453 12.5391 11.9922 11.9922C12.5391 11.4453 12.8125 10.7812 12.8125 10C12.8125 9.21875 12.5391 8.55469 11.9922 8.00781C11.4453 7.46094 10.7812 7.1875 10 7.1875C9.21875 7.1875 8.55469 7.46094 8.00781 8.00781C7.46094 8.55469 7.1875 9.21875 7.1875 10C7.1875 10.7812 7.46094 11.4453 8.00781 11.9922C8.55469 12.5391 9.21875 12.8125 10 12.8125Z"/>
                </g>
              </svg>
              <p className="underline max-md:hidden">Email ME</p>
            </button>
          </Link>
        </div>
      </div>
    </div>
  );
};

export default Header;